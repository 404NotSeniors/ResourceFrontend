all logic for login/register
